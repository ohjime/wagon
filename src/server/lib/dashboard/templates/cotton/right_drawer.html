{% comment %}
Reusable right-side drawer using DaisyUI + Alpine.js + HTMX
- Listens for `right-drawer:open` with optional { title, width }
- Content gets injected into #right-drawer-body via HTMX
{% endcomment %}
<div x-data="rightDrawer()"
     @right-drawer:open.window="open($event.detail)"
     @keydown.escape.window="close()">
    <!-- Backdrop -->
    <div x-show="openState"
         x-transition.opacity
         class="fixed inset-0 z-[60] bg-black/50"
         @click="close()">
    </div>
    <!-- Drawer panel -->
    <aside x-show="openState"
           x-transition:enter="transform transition ease-in-out duration-300"
           x-transition:enter-start="translate-x-full"
           x-transition:enter-end="translate-x-0"
           x-transition:leave="transform transition ease-in-out duration-200"
           x-transition:leave-start="translate-x-0"
           x-transition:leave-end="translate-x-full"
           class="fixed right-0 top-0 bottom-0 z-[70] bg-base-100 border-l border-base-300 shadow-2xl overflow-hidden flex flex-col"
           :class="widthClass"
           aria-label="Right Drawer">
        <!-- Header -->
        <div class="flex items-center justify-between gap-4 px-4 py-3 border-b border-base-300 bg-base-200/40">
            <h3 class="font-semibold truncate"
                x-text="title || 'Details'">
            </h3>
            <div class="flex items-center gap-2">
                <button class="btn btn-ghost btn-sm"
                        @click="close()">
                    Close
                </button>
            </div>
        </div>
        <!-- Body: HTMX target -->
        <div id="right-drawer-body"
             class="flex-1 overflow-auto p-4">
            <!-- HTMX will load content here -->
        </div>
        <!-- Bottom -->
        <div class="bg-base-200 border-base-300 border-t p-4 shadow-lg flex justify-between items-center">
            <!-- Status Select Dropdown -->
            <select class="select !w-40">
                <option>
                    {{ 'Scheduled' }}
                </option>
                <option>
                    {{ 'En Route' }}
                </option>
                <option>
                    {{ 'Arrived' }}
                </option>
                <option>
                    {{ 'In Progress' }}
                </option>
                <option>
                    {{ 'Completed' }}
                </option>
                <option>
                    {{ 'Canceled' }}
                </option>
            </select>
            <!-- Update Button + Actions -->
            <div class="flex items-center gap-2">
                <button class="btn btn-md !bg-green-400">
                    Update
                </button>
                <div class="dropdown dropdown-top dropdown-end">
                    <div tabindex="0"
                         role="button"
                         class="btn btn-md bg-base-100">
                        Actions
                    </div>
                    <ul tabindex="0"
                        class="dropdown-content menu bg-base-100 rounded-box z-1 min-w-max p-2 mb-3 whitespace-nowrap shadow-md">
                        <li>
                            <a>Get Quote</a>
                        </li>
                        <li>
                            <a>Book Return Trip</a>
                        </li>
                        <li class="text-red-600">
                            <a>Delete Ride</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </aside>
    <script>
        function rightDrawer() {
            return {
                openState: false,
                title: null,
                widthClass: 'w-fit max-w-full',
                open(opts = {}) {
                    this.title = opts.title || this.title
                    this.widthClass = opts.width || this.widthClass
                    this.openState = true
                },
                close() {
                    this.openState = false
                    // Optionally clear content after close
                    setTimeout(() => {
                        const body = document.getElementById('right-drawer-body')
                        if (body) body.innerHTML = ''
                    }, 250)
                }
            }
        }
    </script>
</div>
